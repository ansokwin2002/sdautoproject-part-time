<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Integration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header-preview {
            border: 2px solid #e5e5e5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .contact-info {
            display: flex;
            gap: 20px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .contact-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }
        .logo {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #2563eb, #1e40af);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            color: #dc2626;
            background: #fef2f2;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #fecaca;
        }
        .success {
            color: #059669;
            background: #f0fdf4;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #bbf7d0;
        }
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px 10px 0;
        }
        button:hover {
            background: #1d4ed8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SD Auto - API Integration Test</h1>
        
        <div>
            <button onclick="testAPI()">Test API Connection</button>
            <button onclick="loadSettings()">Load Settings</button>
            <button onclick="showFallback()">Show Fallback Data</button>
        </div>

        <div id="status"></div>

        <div class="header-preview">
            <h3>Header Preview</h3>
            
            <div class="logo-section">
                <div class="logo" id="logo">
                    <span id="logoText">SD</span>
                </div>
                <div>
                    <div id="title" style="font-size: 24px; font-weight: bold;">SD AUTO</div>
                    <div id="description" style="color: #666; font-size: 14px;">Parts and Accessories</div>
                </div>
            </div>

            <div class="contact-info">
                <div class="contact-item">
                    <span>üìç</span>
                    <span id="address">SD AUTO Werribee, Victoria 3030 Australia</span>
                </div>
                <div class="contact-item">
                    <span>üìß</span>
                    <span id="email">sdautoaustralia@gmail.com</span>
                </div>
                <div class="contact-item">
                    <span>üìû</span>
                    <span id="phone">+61 460 786 533</span>
                </div>
            </div>
        </div>

        <div>
            <h3>API Response</h3>
            <pre id="apiResponse" style="background: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto;"></pre>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://192.168.1.8:8000/api';
        
        const fallbackData = {
            address: "SD AUTO Werribee, Victoria 3030 Australia",
            email: "sdautoaustralia@gmail.com",
            phone: "+61 460 786 533",
            logo: "/assets/logo.png",
            title: "SD AUTO",
            description: "Parts and Accessories"
        };

        function setStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.className = type;
            statusEl.textContent = message;
        }

        function updateDisplay(data, isLoading = false) {
            if (isLoading) {
                document.getElementById('title').textContent = 'Loading...';
                document.getElementById('description').textContent = 'Loading...';
                document.getElementById('address').textContent = 'Loading...';
                document.getElementById('email').textContent = 'Loading...';
                document.getElementById('phone').textContent = 'Loading...';
                document.getElementById('logoText').textContent = '...';
                return;
            }

            document.getElementById('title').textContent = data.title || fallbackData.title;
            document.getElementById('description').textContent = data.description || fallbackData.description;
            document.getElementById('address').textContent = data.address || fallbackData.address;
            document.getElementById('email').textContent = data.email || fallbackData.email;
            document.getElementById('phone').textContent = data.phone || fallbackData.phone;
            
            const title = data.title || fallbackData.title;
            document.getElementById('logoText').textContent = title.substring(0, 2).toUpperCase();
        }

        async function testAPI() {
            setStatus('Testing API connection...', 'loading');

            try {
                const response = await fetch(`${API_BASE_URL}/public/settings`);
                
                if (response.ok) {
                    setStatus('‚úÖ API connection successful!', 'success');
                    document.getElementById('apiResponse').textContent = `Status: ${response.status} ${response.statusText}`;
                } else {
                    setStatus(`‚ùå API returned error: ${response.status} ${response.statusText}`, 'error');
                    document.getElementById('apiResponse').textContent = `Error: ${response.status} ${response.statusText}`;
                }
            } catch (error) {
                setStatus(`‚ùå Network error: ${error.message}`, 'error');
                document.getElementById('apiResponse').textContent = `Network Error: ${error.message}`;
            }
        }

        async function loadSettings() {
            setStatus('Loading settings from API...', 'loading');
            updateDisplay({}, true);

            try {
                const response = await fetch(`${API_BASE_URL}/public/settings`);
                
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('apiResponse').textContent = JSON.stringify(data, null, 2);
                    
                    if (data.success && data.data && data.data.length > 0) {
                        const settings = data.data[0];
                        updateDisplay(settings);
                        setStatus('‚úÖ Settings loaded successfully from API!', 'success');
                    } else {
                        updateDisplay(fallbackData);
                        setStatus('‚ö†Ô∏è No settings found, using fallback data', 'error');
                    }
                } else {
                    updateDisplay(fallbackData);
                    setStatus(`‚ùå API error: ${response.status}, using fallback data`, 'error');
                    document.getElementById('apiResponse').textContent = `Error: ${response.status} ${response.statusText}`;
                }
            } catch (error) {
                updateDisplay(fallbackData);
                setStatus(`‚ùå Network error: ${error.message}, using fallback data`, 'error');
                document.getElementById('apiResponse').textContent = `Network Error: ${error.message}`;
            }
        }

        function showFallback() {
            updateDisplay(fallbackData);
            setStatus('Showing fallback data', 'success');
            document.getElementById('apiResponse').textContent = JSON.stringify(fallbackData, null, 2);
        }

        // Load settings on page load
        window.addEventListener('load', loadSettings);
    </script>
</body>
</html>
